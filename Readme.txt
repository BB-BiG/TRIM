
************************************************************************************************
Data cleaning:
C source code: 'data_cleaning.c'
Executable code: 'data_cleaning'

i) What is does?

   The code is used to remove all the non-acgt charaters including annotations and delimeters from a genome sequence. 

ii) System commands to do the task

   To compile the source code 'data_cleaning.c':    $gcc data_cleaning.c -o data_cleaning -DMAX=0 
  
   (The option -DMAX=0 indicates acgt characters in the sequence are kept unchanged)

   To run the executable code 'data_cleaning':   $./data_cleaning Genome.fna Genome.fna.txt

   'Genome.fna' is input file. It contains raw genome sequence that includes the non-acgt characters, annotations and delimeters.
   
    The output will be stored in a file 'Genome.fna.txt' or any user specified filename, which will be the clean sequence containing only the acgt characters. 

Note: Cleaning genome sequence is mandatory for correct working of all other executables. 


****************************************************************************************************
Computation of TRIM vectors 
C code: 'TRIM.c'
Executable code: 'TRIM'


i) What is does?

   Transforms genomic sequences into their corresponding TRIM vectors. Here, we assume that all the genome sequences 
   have been cleaned by the 'data_cleaning' utility.  
 
ii)  System commands to do the task

     To compile the source code 'TRIM.c':   $gcc TRIM.c -DMAX=3900000000 -lm -o TRIM

     (The option -DMAX indicates maximum length of genome the program will accomodate in RAM, which is presently 
     the maximum available genome length of the species taken from in NCBI repository under this study. 
     For any genome upto this length, user need not specify length of the experimenting sequence.)
 
     To run the executable code 'TRIM':  $./TRIM 
     
     A typical output instance of the executable 'TRIM'
     
     .............................................
     Enter motif/k-mer length: 7
     Enter the number of genomes to convert in TRIM vector: 4
     Input file name: Genome1.fna.txt
     Constructing TRIM vector for genome stored in file: Genome1.fna.txt
     Storing the TRIM vector in: TRIM_vector_Genome1.txt
     Input file name: Genome2.fna.txt
     Constructing TRIM vector for genome stored in file: Genome2.fna.txt
     Storing the TRIM vector in: TRIM_vector_Genome2.txt
     Input file name: Genome3.fna.txt
     Constructing TRIM vector for genome stored in file: Genome3.fna.txt
     Storing the TRIM vector in: TRIM_vector_Genome3.txt
     Input file name: Genome4.fna.txt
     Constructing TRIM vector for genome stored in file: Genome4.fna.txt
     Storing the TRIM vector in: TRIM_vector_Genome4.txt
     
     Note: The utility 'TRIM' automaically assigns the filename 'TRIM_vector_GenomeN.txt' and store the TRIM vector correspond 
     to the N-th input genome into that file. However, the input filename can be any user specified filename that contain a
     cleaned genomic sequence. In other words, the utility 'TRIM' will store the TRIM vector for the first input genome into
     a file named TRIM_vector_Genome1.txt, the TRIM vector for the second input genome into a file named TRIM_vector_Genome2.txt 
     and so on. 
     
     
    

*******************************************************************************************************
Application: Phylogeny construction


We have used the distance-matrix based phylogney. There are two major steps in computation of distance-matrix based phylogney 

a) Computation of distance matrix. 

 C code: 'TRIM_distance_matrix.c'
 Executable code: 'TRIM_distance_matrix'

i) What is does?

   Computes TRIM distance matrix from a set of TRIM vectors. The TRIM vectors should be generated by using the utility 'TRIM'
   so that the files containing the TRIM vectors have the apropriate naming convention i.e., 'TRIM_vector_GenomeN.txt'. 
   
 
ii)  System commands to do the task

     To compile the source code 'TRIM_distance_matrix.c':   $gcc TRIM_distance_matrix.c -lm -o TRIM_distance_matrix

     To run the executable code 'TRIM_distance_matrix':   $./TRIM_distance_matrix
     
     A typial output instance of the executable 'TRIM_distance_matrix'
     ........................................
     Enter the number of TRIM vectors to construct TRIM distance matrix: 12
     TRIM distance matrix is written into filename: TRIM_distance_matrix.txt
     
     
b) Contruction of phylogeny tree using hierarchical clustering algorithm NJ from the distance matrix.

  In this step we have used MATLAB to costruct the phylogeny tree from the distance matrix stored in 'TRIM_distance_matrix.txt'.
  The following MATLAB script will load the TRIM distance matrix from file 'TRIM_distance_matrix.txt' into a MATLAB variable 'D'
  
  .........................................
  >>myfile = 'TRIM_distance_matrix.txt';
  >>text = fileread(myfile);
  >>arr_text = strsplit(text);
  >>x = char(arr_text); x_n = str2num(x); x_n = x_n';
  >>D = x_n; 
  ...........................................
  
  From the distance matrix stored in varable 'D' we can construct the phylogeny tree using NJ method as 
  
  .....................................
  >>phy = seqneighjoin(D,'equivar');
  .....................................
  
  To get the Newick format string of the phylogney tree we can use the following script
  .............................
  >>getnewickstr(phy)
  ............................
  
  From the newick formatted string we draw the phylogeny trees using MEGA 7.0. However, any other tools can be used.
  
  

Application: Taxa identification

C source code: 'TRIMEC.c'
Executable code: 'TRIMEC'

i) What is does?

  It is used to identify the taxa of a given genome sequence and do not require any other information.
 
ii)  System commands to do the task

 To compile the source code 'TRIMEC.c': $gcc TRIMEC.c -DAMX=38900000000 lm -o TRIMEC
 
  (The option -DMAX indicates maximum length of genome the program will accomodate in RAM, which is presently 
     the maximum available genome length of the species taken from in NCBI repository under this study. 
     For any genome upto this length, user need not specify length of the experimenting sequence.)
 
 Note: Execution of TRIMEC depends on two training sets stored in the files 
 
 1. 'Bagging_classifier_at_k=7.txt' 
 2. 'Bagging_classifier_at_k=6.txt' 
 
 Based on maximization of H, TRIMEC loads either of this file to identify taxa of the given genome sequence. Thus these two files
 should be present in the same directory with the executable 'TRIMEC'. These files were generated while training the TRIMEC, hence
 shoule be available with 'TRIMEC'. 
 
 However, due to the constraints of 'Github' we are unable to upload the file 'Bagging_classifier_at_k=7.txt' as its size
 is greater than 25 MB limit. Thus, we have split the file 'Bagging_classifier_at_k=7.txt' into three files 'part1.txt',
 'part2.txt' and 'part3.txt' and have uploaded the files as 
 
 a) 'Bagging_classifier_at_k=6.txt'
 b) 'part1.txt'
 c) 'part2.txt'
 d) 'part3.txt'
 
 User need to use the following command before running the 'TRIMEC'
 
 $cat part1.txt part2.txt part3.txt > 'Bagging_classifier_at_k=7.txt'
 
 ***It is to be note that the filenames should be 'Bagging_classifier_at_k=7.txt' and
 'Bagging_classifier_at_k=6.txt' for proper working of TRIMEC.
 
 
 To run the executable file 'TRIMEC': $./TRIMEC
 
 A typical instance of the executalbe 'TRIMEC' is as 
 
 .......................................................
 
 
 ...........................Welcome to genome classifier utility.....................

Input file name of the genome to identify its taxa: D11.txt
...........................System is performing the following tasks................

Constructing TRIM vector for the genome stored in file: D11.txt ... 
at k=6
19026.705265
at k=7
23379.252336

Total interval entropy (H) maximizes at k=7
Loading corresponding classifier at k=7....
Output of classifier 0
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.109691 
Reptile: 0.086175 
Bird: 0.040884 
Insect: 0.407014 
Fish: 0.097783 
Mammal: 0.090883 
Non-animal: 0.285118 

Output of classifier 1
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.111067 
Reptile: 0.081358 
Bird: 0.045383 
Insect: 0.401142 
Fish: 0.099666 
Mammal: 0.091016 
Non-animal: 0.265147 

Output of classifier 2
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.111698 
Reptile: 0.118272 
Bird: 0.040906 
Insect: 0.399459 
Fish: 0.097152 
Mammal: 0.091534 
Non-animal: 0.265147 

Output of classifier 3
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.109294 
Reptile: 0.092244 
Bird: 0.043210 
Insect: 0.417346 
Fish: 0.098491 
Mammal: 0.091087 
Non-animal: 0.265147 

Output of classifier 4
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.108573 
Reptile: 0.089151 
Bird: 0.042039 
Insect: 0.407014 
Fish: 0.097605 
Mammal: 0.091241 
Non-animal: 0.265147 

Output of classifier 5
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.110941 
Reptile: 0.086642 
Bird: 0.050130 
Insect: 0.399528 
Fish: 0.100942 
Mammal: 0.091204 
Non-animal: 0.282800 

Output of classifier 6
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.106303 
Reptile: 0.100883 
Bird: 0.048903 
Insect: 0.390352 
Fish: 0.100366 
Mammal: 0.091332 
Non-animal: 0.285118 

Output of classifier 7
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.110123 
Reptile: 0.082703 
Bird: 0.048632 
Insect: 0.386168 
Fish: 0.100228 
Mammal: 0.091076 
Non-animal: 0.265147 

Output of classifier 8
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.108953 
Reptile: 0.089151 
Bird: 0.046997 
Insect: 0.383405 
Fish: 0.096158 
Mammal: 0.090610 
Non-animal: 0.265147 

Output of classifier 9
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.112096 
Reptile: 0.081088 
Bird: 0.042736 
Insect: 0.401142 
Fish: 0.098992 
Mammal: 0.090659 
Non-animal: 0.265147 

Output of classifier 10
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.110357 
Reptile: 0.089151 
Bird: 0.039225 
Insect: 0.442519 
Fish: 0.097020 
Mammal: 0.091420 
Non-animal: 0.285118 

Output of classifier 11
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.108280 
Reptile: 0.082703 
Bird: 0.035661 
Insect: 0.401142 
Fish: 0.100002 
Mammal: 0.091058 
Non-animal: 0.265147 

Output of classifier 12
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.110488 
Reptile: 0.086642 
Bird: 0.036960 
Insect: 0.399459 
Fish: 0.096525 
Mammal: 0.091101 
Non-animal: 0.265147 

Output of classifier 13
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.115087 
Reptile: 0.090642 
Bird: 0.038982 
Insect: 0.399459 
Fish: 0.098246 
Mammal: 0.091051 
Non-animal: 0.265147 

Output of classifier 14
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.107625 
Reptile: 0.082603 
Bird: 0.049336 
Insect: 0.389461 
Fish: 0.099539 
Mammal: 0.090983 
Non-animal: 0.265147 

Output of classifier 15
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.119480 
Reptile: 0.083100 
Bird: 0.037288 
Insect: 0.383405 
Fish: 0.096801 
Mammal: 0.091551 
Non-animal: 0.285118 

Output of classifier 16
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.114246 
Reptile: 0.082603 
Bird: 0.038385 
Insect: 0.399459 
Fish: 0.100460 
Mammal: 0.091390 
Non-animal: 0.282800 

Output of classifier 17
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.110641 
Reptile: 0.081088 
Bird: 0.042139 
Insect: 0.383405 
Fish: 0.097257 
Mammal: 0.090561 
Non-animal: 0.265147 

Output of classifier 18
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.107484 
Reptile: 0.090642 
Bird: 0.042477 
Insect: 0.389461 
Fish: 0.096830 
Mammal: 0.091418 
Non-animal: 0.282800 

Output of classifier 19
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.111511 
Reptile: 0.082603 
Bird: 0.035895 
Insect: 0.383405 
Fish: 0.097637 
Mammal: 0.090662 
Non-animal: 0.282800 

Output of classifier 20
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.117847 
Reptile: 0.095898 
Bird: 0.050672 
Insect: 0.386168 
Fish: 0.099714 
Mammal: 0.091216 
Non-animal: 0.265147 

Output of classifier 21
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.112496 
Reptile: 0.082703 
Bird: 0.042113 
Insect: 0.383405 
Fish: 0.097194 
Mammal: 0.091038 
Non-animal: 0.265147 

Output of classifier 22
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.113165 
Reptile: 0.081088 
Bird: 0.047514 
Insect: 0.386168 
Fish: 0.098234 
Mammal: 0.090914 
Non-animal: 0.265147 

Output of classifier 23
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.112496 
Reptile: 0.095366 
Bird: 0.048541 
Insect: 0.383405 
Fish: 0.098348 
Mammal: 0.091303 
Non-animal: 0.282800 

Output of classifier 24
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.107625 
Reptile: 0.089078 
Bird: 0.044162 
Insect: 0.383405 
Fish: 0.099620 
Mammal: 0.090067 
Non-animal: 0.285118 



Based on the maximum agreement among the 25 classifier under TRIMEC
This is a Bird
 
................................................

We have also implemented the utility that can identify taxa of a genome from its partial sequence. The utility also requires that
the same training files 'Bagging_classifier_at_k=7.txt' and 'Bagging_classifier_at_k=6.txt' should be present in the same directory. 

C source code: 'TRIMEC_p.c'
Executable code: 'TRIMEC_p'

To compile the source code 'TRIMEC_p.c': $gcc TRIMEC.c -DAMX=38900000000 lm -o TRIMEC_p

To run the executable file 'TRIMEC_p': $./TRIMEC_P
 
A typical output instance of the executable 'TRIMEC_p' is as 

..................................................

...........................Welcome to genome classifier utility.....................

Input file name of the genome to identify its taxa: D11.txt
...........................System is performing the following tasks................

Constructing TRIM vector for the genome stored in file: D11.txt ... 
Enter start and end range for partial tests: range should be within 0<= range <=1
0.2 0.8

at k=6
19026.705265
at k=7
23379.252336

Total interval entropy (H) maximizes at k=7
Locading corresponding classifier at k=7....
Output of classifier 0
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.109691 
Reptile: 0.086175 
Bird: 0.040884 
Insect: 0.407014 
Fish: 0.097783 
Mammal: 0.090883 
Non-animal: 0.285118 

Output of classifier 1
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.111067 
Reptile: 0.081358 
Bird: 0.045383 
Insect: 0.401142 
Fish: 0.099666 
Mammal: 0.091016 
Non-animal: 0.265147 

Output of classifier 2
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.111698 
Reptile: 0.118272 
Bird: 0.040906 
Insect: 0.399459 
Fish: 0.097152 
Mammal: 0.091534 
Non-animal: 0.265147 

Output of classifier 3
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.109294 
Reptile: 0.092244 
Bird: 0.043210 
Insect: 0.417346 
Fish: 0.098491 
Mammal: 0.091087 
Non-animal: 0.265147 

Output of classifier 4
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.108573 
Reptile: 0.089151 
Bird: 0.042039 
Insect: 0.407014 
Fish: 0.097605 
Mammal: 0.091241 
Non-animal: 0.265147 

Output of classifier 5
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.110941 
Reptile: 0.086642 
Bird: 0.050130 
Insect: 0.399528 
Fish: 0.100942 
Mammal: 0.091204 
Non-animal: 0.282800 

Output of classifier 6
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.106303 
Reptile: 0.100883 
Bird: 0.048903 
Insect: 0.390352 
Fish: 0.100366 
Mammal: 0.091332 
Non-animal: 0.285118 

Output of classifier 7
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.110123 
Reptile: 0.082703 
Bird: 0.048632 
Insect: 0.386168 
Fish: 0.100228 
Mammal: 0.091076 
Non-animal: 0.265147 

Output of classifier 8
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.108953 
Reptile: 0.089151 
Bird: 0.046997 
Insect: 0.383405 
Fish: 0.096158 
Mammal: 0.090610 
Non-animal: 0.265147 

Output of classifier 9
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.112096 
Reptile: 0.081088 
Bird: 0.042736 
Insect: 0.401142 
Fish: 0.098992 
Mammal: 0.090659 
Non-animal: 0.265147 

Output of classifier 10
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.110357 
Reptile: 0.089151 
Bird: 0.039225 
Insect: 0.442519 
Fish: 0.097020 
Mammal: 0.091420 
Non-animal: 0.285118 

Output of classifier 11
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.108280 
Reptile: 0.082703 
Bird: 0.035661 
Insect: 0.401142 
Fish: 0.100002 
Mammal: 0.091058 
Non-animal: 0.265147 

Output of classifier 12
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.110488 
Reptile: 0.086642 
Bird: 0.036960 
Insect: 0.399459 
Fish: 0.096525 
Mammal: 0.091101 
Non-animal: 0.265147 

Output of classifier 13
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.115087 
Reptile: 0.090642 
Bird: 0.038982 
Insect: 0.399459 
Fish: 0.098246 
Mammal: 0.091051 
Non-animal: 0.265147 

Output of classifier 14
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.107625 
Reptile: 0.082603 
Bird: 0.049336 
Insect: 0.389461 
Fish: 0.099539 
Mammal: 0.090983 
Non-animal: 0.265147 

Output of classifier 15
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.119480 
Reptile: 0.083100 
Bird: 0.037288 
Insect: 0.383405 
Fish: 0.096801 
Mammal: 0.091551 
Non-animal: 0.285118 

Output of classifier 16
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.114246 
Reptile: 0.082603 
Bird: 0.038385 
Insect: 0.399459 
Fish: 0.100460 
Mammal: 0.091390 
Non-animal: 0.282800 

Output of classifier 17
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.110641 
Reptile: 0.081088 
Bird: 0.042139 
Insect: 0.383405 
Fish: 0.097257 
Mammal: 0.090561 
Non-animal: 0.265147 

Output of classifier 18
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.107484 
Reptile: 0.090642 
Bird: 0.042477 
Insect: 0.389461 
Fish: 0.096830 
Mammal: 0.091418 
Non-animal: 0.282800 

Output of classifier 19
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.111511 
Reptile: 0.082603 
Bird: 0.035895 
Insect: 0.383405 
Fish: 0.097637 
Mammal: 0.090662 
Non-animal: 0.282800 

Output of classifier 20
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.117847 
Reptile: 0.095898 
Bird: 0.050672 
Insect: 0.386168 
Fish: 0.099714 
Mammal: 0.091216 
Non-animal: 0.265147 

Output of classifier 21
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.112496 
Reptile: 0.082703 
Bird: 0.042113 
Insect: 0.383405 
Fish: 0.097194 
Mammal: 0.091038 
Non-animal: 0.265147 

Output of classifier 22
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.113165 
Reptile: 0.081088 
Bird: 0.047514 
Insect: 0.386168 
Fish: 0.098234 
Mammal: 0.090914 
Non-animal: 0.265147 

Output of classifier 23
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.112496 
Reptile: 0.095366 
Bird: 0.048541 
Insect: 0.383405 
Fish: 0.098348 
Mammal: 0.091303 
Non-animal: 0.282800 

Output of classifier 24
TRIM distance of the given genme from Mean TRIM Vector of 

Amphibian: 0.107625 
Reptile: 0.089078 
Bird: 0.044162 
Insect: 0.383405 
Fish: 0.099620 
Mammal: 0.090067 
Non-animal: 0.285118 



Based on the maximum agreement among the 25 classifier under TRIMEC
This is a Bird

